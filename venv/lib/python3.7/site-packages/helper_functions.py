#!/usr/bin/env python3

from typing import IO

"""Helper functions for pentesting scripts"""

def lazy_load(file_: IO, sep: str = "\n", block_size: int = 1024):
    """load a file into memory in block_size chunks and return it up to the next separator."""
    last_fragment = ""
    while True:
        block = file_.read(block_size)
        if not block:
            break
        block_fragments = iter(block.split(sep))
        last_fragment += next(block_fragments)
        for fragment in block_fragments:
            yield last_fragment
            last_fragment = fragment
        yield last_fragment


