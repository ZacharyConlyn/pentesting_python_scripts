#!/usr/bin/env python3

import nmap
import argparse


def nmap_scan(target_host, target_port):
    scanner = nmap.PortScanner()
    scanner.scan(target_host, target_port)
    state = scanner[target_host]['tcp'][int(target_port)]['state']
    print(f"[*] {target_host} tcp/{target_port} {state}")


def main():
    parser = argparse.ArgumentParser()
    optional = parser._action_groups.pop()
    required = parser.add_argument_group("required arguments")
    optional = parser.add_argument_group("optional arguments")
    required.add_argument("-H", "--host", type=str, help="target host", required=True)
    required.add_argument("-p", "--ports", type=str, help="target ports", required=True)
    args = parser.parse_args()

    target_host = args.host
    target_ports = args.ports.split(",")

    for port in target_ports:
        nmap_scan(target_host, port)


if __name__ == "__main__":
    main()


